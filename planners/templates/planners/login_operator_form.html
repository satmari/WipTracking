{% extends "core/base.html" %}
{% load static %}

{% block title %}
  {% if object %}
    Edit Operator Login
  {% else %}
    Add Operator Login
  {% endif %}
{% endblock %}

{% block content %}
<div class="container-fluid mt-4">

  <div class="d-flex justify-content-between align-items-center mb-3">
    <h1 class="h4 mb-0">
      {% if object %}
        Edit Operator Login
      {% else %}
        Add Operator Login
      {% endif %}
    </h1>

    <a href="{% url 'planners:login_operator_list' %}"
       class="btn btn-sm btn-outline-secondary">
      ‚Üê Back
    </a>
  </div>

  <div class="card shadow-sm">
    <div class="card-body">

      <form method="post">
        {% csrf_token %}

        {% if form.non_field_errors %}
          <div class="alert alert-danger">
            {{ form.non_field_errors }}
          </div>
        {% endif %}

        <!-- ========================= -->
        <!-- BASIC FIELDS -->
        <!-- ========================= -->

        <div class="row g-3">

          {% for field in form %}
            {% if field.name != "break_time" %}
              <div class="col-md-6">
                <label class="form-label">
                  {{ field.label }}
                </label>

                {{ field }}

                {% if field.help_text %}
                  <div class="form-text">
                    {{ field.help_text }}
                  </div>
                {% endif %}

                {% for error in field.errors %}
                  <div class="text-danger small">
                    {{ error }}
                  </div>
                {% endfor %}
              </div>
            {% endif %}
          {% endfor %}

        </div>

        <!-- ========================= -->
        <!-- BREAK TIME -->
        <!-- ========================= -->

        <hr class="my-4">

        <div class="row">
          <div class="col-md-4">

            <label class="form-label">Break (minutes)</label>

            <select name="break_time" class="form-select">
              <option value=""
                {% if form.instance.break_time is None %}
                  selected
                {% endif %}>
                None
              </option>

              {% for m in range_0_30 %}
                <option value="{{ m }}"
                  {% if form.instance.break_time == m %}
                    selected
                  {% endif %}>
                  {{ m }}
                </option>
              {% endfor %}
            </select>

            <div class="form-text">
              Manual override of break duration (minutes).
            </div>

          </div>
        </div>

        <!-- ========================= -->
        <!-- QUICK BREAK BUTTONS (EDIT ONLY) -->
        <!-- ========================= -->

        {% if object %}
          <div class="row mt-3">
            <div class="col-md-6">

              <label class="form-label">Quick break</label>

              <div class="d-flex gap-2">
                <button type="submit"
                        name="set_break"
                        value="0"
                        class="btn btn-outline-secondary btn-sm">
                  Save + Set 0 min
                </button>

                <button type="submit"
                        name="set_break"
                        value="30"
                        class="btn btn-outline-success btn-sm">
                  Save + Set 30 min
                </button>
              </div>

            </div>
          </div>
        {% endif %}

        <!-- ========================= -->
        <!-- ACTIONS -->
        <!-- ========================= -->

        <div class="mt-4 d-flex gap-2">
          <button type="submit" class="btn btn-primary">
            Save
          </button>

          <a href="{% url 'planners:login_operator_list' %}"
             class="btn btn-outline-secondary">
            Cancel
          </a>
        </div>

      </form>

    </div>
  </div>
</div>
{% endblock %}
