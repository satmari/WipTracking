{% extends 'core/base.html' %}
{% load static %}

{% block title %}Operators{% endblock %}

{% block content %}
<div class="container mt-4">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h1 class="h4 mb-0">Operators</h1>
    <div>
      <a href="{% url 'planners:operator_add' %}" class="btn btn-primary btn-sm">
        + Add Operator
      </a>

      <form method="post"
            action="{% url 'planners:operator_sync' %}"
            class="d-inline ms-2">
        {% csrf_token %}
        <button type="submit"
                class="btn btn-danger btn-sm"
                onclick="return confirm('Synchronize operators with Inteos?');">
          Synchronize with Inteos
        </button>
      </form>
    </div>
  </div>

  <div class="card shadow-sm">
    <div class="card-body">
      <table class="table table-striped table-hover mb-0" id="operators-table">
        <thead class="table-light">
          <tr>
            <th>ID</th>
            <th>Badge #</th>
            <th>Name</th>
            <th>Active</th>
            <th>Function</th>
<!--            <th>Created</th>-->
            <th>Updated</th>
            <th class="text-end">Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for op in operators %}
          <tr>
            <td>{{ op.id }}</td>
            <td>{{ op.badge_num }}</td>
            <td>{{ op.name }}</td>
            <td>
              {% if op.act %}
                <span class="badge bg-success">Active</span>
              {% else %}
                <span class="badge bg-secondary">Inactive</span>
              {% endif %}
            </td>
            <td>{{ op.func }}</td>
<!--            <td>{{ op.created_at|date:"d.m.Y. H:i" }}</td>-->
            <td>{{ op.updated_at|date:"d.m.Y. H:i" }}</td>
            <td class="text-end">
              <a href="{% url 'planners:operator_edit' op.pk %}" class="btn btn-sm btn-outline-secondary">Edit</a>
              <a href="{% url 'planners:operator_delete' op.pk %}" class="btn btn-sm btn-outline-danger">Delete</a>
            </td>
          </tr>
          {% empty %}
          <tr>
            <td colspan="8" class="text-center text-muted">No operators yet.</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>
{% endblock %}

{% block scripts %}
<script>
  $(document).ready(function() {
    var table = $('#operators-table').DataTable({
      paging: true,
      ordering: true,
      searching: true,
      pageLength: 20,
      lengthMenu: [10, 25, 50, 100, 500],
      responsive: true,
      scrollCollapse: true
    });

    new $.fn.dataTable.FixedHeader(table);
  });
</script>
{% endblock %}
